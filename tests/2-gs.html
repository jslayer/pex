<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<div id="test">
    <fieldset>
        <legend>
            <label>
                <input type="checkbox" a2-model="showForm" checked /> Form
            </label>
        </legend>
        <div a2-show="showForm">
            Name: <input type="text" a2-model="newUserName" a2-enter="onEnterHandler" />
            Surname: <input type="text" a2-model="newUserSurname" a2-enter="onEnterHandler" />

            After :
            <select a2-for="user, i in users" a2-model="newUserAfter">
                <option a2-model="i">{{ i }}</option>
            </select>

            ModelValue = {{ newUserAfter }}

            <hr>

            <ul a2-for="user in users">
                <li>{{ user.name }} {{ user.surname }}</li>
            </ul>

            <table a2-for="user, i in users">
                <tr>
                    <td>{{ i }}</td>
                    <td>{{ user.name }}</td>
                    <td>{{ user.surname }}</td>
                    <td><input a2-model="user.name" /></td>
                    <td><input a2-model="user.surname" /></td>
                    <td>
                        <button a2-click="deleteItem users, i">x</button>
                    </td>
                </tr>
            </table>
        </div>
    </fieldset>
</div>
<script src="a2.js"></script>
<script>
    var a2 = new A2({
        node : document.getElementById('test')
    });

    a2.plug(Plugins.PluginNodeForIn);
    a2.plug(Plugins.PluginNodeText);
    a2.plug(Plugins.PluginNodeModel);
    a2.plug(Plugins.PluginNodeEnter);
    a2.plug(Plugins.PluginNodeClick);
    a2.plug(Plugins.PluginNodeShow);
    a2.plug(Plugins.PluginNodeHide);

    a2.onEnterHandler = function(tree){
        var un = this.newUserName,
            us = this.newUserSurname;

        if (un && us) {
            var value = {
                name    : un,
                surname : us
            };

            if (value) {

                if (!('users' in this)) {
                    this.host.define('users', {
                        value : []
                    });
                }

                this.users.push(value);

                this.newUserName = '';
                this.newUserSurname = '';
            }
        }
    };

    a2.deleteItem = function(list, index){
        list.splice(index, 1);
    };

    a2.init();

    a2.users = [
        {
            name    : 'Tyler',
            surname : 'Durden'
        },
        {
            name    : 'Marla',
            surname : 'Singer'
        },
        {
            name    : 'Luka',
            surname : 'Sakun'
        },
        {
            name    : 'Eugene',
            surname : 'Poltorakov'
        }
    ];

    a2.newUserAfter = 1;

</script>
</body>
</html>
